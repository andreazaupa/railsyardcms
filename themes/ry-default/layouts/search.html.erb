<%# 
  Authors:
    Silvio Relli  (mailto:silvio@relli.org)
    Matteo Papadopoulos (mailto:matteo.papadopoulos@basictrading.biz)
  Licence:
    released under MIT License
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title><%= @meta_title %></title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="description" content="<%= @meta_desc %>" />
  <meta name="keywords" content="<%= @meta_keyword %>" />
  <style type="text/css" media="screen">@import "/stylesheets/ry-default/reset.css";</style>
  <style type="text/css" media="screen">@import "/stylesheets/ry-default/style.css";</style>
  <style type="text/css" media="screen">@import "/stylesheets/ry-default/carousel.css";</style>
  <style type="text/css" media="screen">@import "/stylesheets/ry-default/lightwindow.css";</style>
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz">
  <link rel="shortcut icon" href="/images/favicon.gif" type="image/gif" />
  <!--[if lte IE 7]>
  <style type="text/css" media="screen">@import "/stylesheets/ry-default/style-ie7.css";</style>
  <![endif]-->
  <%= auto_discovery_link_tag(:atom, "/feeds.atom") %>
  <%= javascript_include_tag :defaults, 'carousel.packed', 'lightwindow', 'hint-textbox' %>
  <script type="text/javascript">
// var columns = $$('div.column'),
// height = columns.inject(0, function (acc, el) {
//   var h = el.getHeight();
//   return (h > acc) ? h : acc;
// });
// columns.invoke('setStyle', { height: height + 'px'});
  
  
  function matchColumns(){
  var columns = $$('div.column');
  var max_height = columns.invoke('getHeight').max();
  columns.invoke('setStyle', {height: (max_height + 10) + 'px'});
  }
  Event.observe(window, 'load', matchColumns);
  </script>
  
  <%= yield :script %>
</head>
<body>
<!--[if lt IE 7]>
  <div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>
    <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>
    <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>
      <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>
      <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>
        <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>Stai usando un browser obsoleto</div>
        <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>Per una migliore navigazione su questo sito, per cortesia passa ad un browser di ultima generazione.</div>
      </div>
      <div style='width: 75px; float: left;'><a href='http://www.mozilla-europe.org/it/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox 3.5'/></a></div>
      <div style='width: 75px; float: left;'><a href='http://www.microsoft.com/downloads/details.aspx?FamilyID=341c2ad5-8c3d-4347-8c03-08cdecd8852b&DisplayLang=it' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-ie8.jpg' style='border: none;' alt='Get Internet Explorer 8'/></a></div>
      <div style='width: 73px; float: left;'><a href='http://www.apple.com/it/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari 4'/></a></div>
      <div style='float: left;'><a href='http://www.google.com/chrome?hl=it' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>
    </div>
  </div>
  <![endif]-->
  
  
  <div id="header">
    <h1><%= link_to @cfg.site_name, yard_home_link %></h1>
    <h2><%= @cfg.site_desc %></h2>
    
    <ul id="lang_selector">
      <li class="eng"><%= link_to "English".hs, '/en' %></li>
      <li class="ita"><%= link_to "Italiano".hs, '/it' %></li>
    </ul>
    <%= yield :header %>
  </div>
  
  <!-- thanks to http://www.manisheriar.com/holygrail/index.htm for 3 col template -->
  <div id="wrapper1"><!-- sets background to white and creates full length leftcol-->
    <div id="wrapper2"><!-- sets background to white and creates full length rightcol-->
    <% if @pg %>
	  <div id="maincol" <%= "class='#{@pg.div_class}'" unless @pg.div_class.blank?%> <%= "style='#{@pg.div_style}'" unless @pg.div_style.blank? %>><!-- begin main content area -->
    <% else %>
	  <div id="maincol"><!-- begin main content area -->
	<% end %>
        <div id="leftcol"  class="column"><!-- begin leftcol -->
        <% if @pg %>
  	      <%= yield :left %>
  	    <% else %>
  	  	<!-- Placeholder for static content -->
  		  <ul>
          <% yard_home.self_and_siblings.for_language(get_lang).map do |p| %>
            <% if p.visible_in_menu && p.published %><li><%= link_to "<span>#{p.name}</span>".san, get_yard_url(p.pretty_url) %></li><% end %>
          <% end %>
          </ul>
  	    <% end %>
        </div><!-- end leftcol -->
  
        <div id="rightcol"  class="column"><!-- begin rightcol -->          
        <% if current_user %>
          <div id="login-box" class="logged">
            <h2><%= t('public.general.hi') %> <%= current_user.login %></h2>
            <% if current_user.is_admin?  %>
            <ul>
              <li><%= link_to t('public.general.admin_area'), '/admin' %></li>
              <li><%= link_to t('public.general.logout'), logout_path %></li>
            </ul>
            <% end %>
          </div>
        <% else %>
          <div class="user-area login">
          <% form_tag session_path do %>
            <fieldset>
              <legend>Login</legend>
              <div><%= label_tag t('public.general.username') %>
                <%= text_field_tag 'login', @login, :class => 'username' %>
			  </div>
              <div><%= label_tag t('public.general.password') %>
                <%= password_field_tag 'password', nil, :class => 'password' %>
			  </div>
              <div><%= check_box_tag 'remember_me', '1', @remember_me, :class => 'remember' %> <%= label_tag t('public.general.remember_me') %></div>
              <div class="buttons">
                <%= submit_tag t('public.general.login').upcase, :class => 'login-button' %>
                <input type="button" value="<%= t('public.general.signup') %>" onclick="document.location='<%= new_user_path() %>'" />
              </div>
            </fieldset>
          <% end %>
          </div>
        <% end %>
        <% if @pg %>
		  <%= yield :right %>
	    <% else %>
		  <!-- Placeholder for static content -->
		<% end %>
        </div><!-- end righttcol -->
  
        <div id="centercol" class="column"><!-- begin centercol -->
        <% if @pg %>
		  <%= yield :center %>
		<% else %>
		  <%= yield %>
		  <!-- Placeholder for static content -->
		<% end %>
        </div><!-- end centercol -->
      </div><!-- end main content area -->
	
	  <div id="extra"><!-- begin extra area -->
	  <% if @pg %>
	    <%= yield :extra %>
	  <% else %>
	    <!-- Placeholder for static content -->
	  <% end %>
	  </div><!-- end extra -->
      
      <div id="extra"><!-- begin extra area -->
	  <% if @pg %>
	    <%= yield :footer %>
	  <% else %>
	    <!-- Placeholder for static content -->
	  <% end %>
	  </div><!-- end extra -->
	
    </div><!-- end wrapper2 -->
  </div><!-- end wrapper1 -->
  
  <div id="credits">
    <p>Powered by <%= link_to "Railsyard CMS", "http://www.railsyardcms.org" %></p>
  </div>

  <div class="alerts">
    <% if flash[:notice] || flash[:error] %>
    <div id="alerts-box">
      <% if flash[:notice] %>
      <div id="notice">
        <p><%= flash[:notice] %></p>
      </div>
      <script type="text/javascript">
        $('notice').pulsate();
      </script>
      <% end %>
      <% if flash[:error] %>
      <div id="error">
        <%= flash[:error] %>
      </div>
      <script type="text/javascript">
        $('error').pulsate();
      </script>
      <% end %>
    </div>
    <% end %>
  </div>
  <%= @cfg.analytics.hs unless @cfg.analytics.blank? %>

</body>
</html>

